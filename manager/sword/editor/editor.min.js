/*!
 * --------------------------------------------------------------------
 *  SIMPLE TEXT SELECTION LIBRARY FOR ONLINE TEXT EDITING (2014-03-19)
 * --------------------------------------------------------------------
 * => https://github.com/tovic/simple-text-editor-library
 * --------------------------------------------------------------------
 */

;var Editor=function(a){var b=this,c=[],d=0,e=null;b.area="undefined"!=typeof a?a:document.getElementsByTagName("textarea")[0],c[d]={value:b.area.value,selectionStart:0,selectionEnd:0},d++,b.selection=function(){var a=b.area.selectionStart,c=b.area.selectionEnd,d=b.area.value.substring(a,c),e=b.area.value.substring(0,a),f=b.area.value.substring(c),g={start:a,end:c,value:d,before:e,after:f};return g},b.select=function(a,c,d){b.area.focus(),b.area.setSelectionRange(a,c),"function"==typeof d&&d()},b.replace=function(a,c,d){var e=b.selection(),f=e.start,h=(e.end,e.value.replace(a,c));b.area.value=e.before+h+e.after,b.select(f,f+h.length),"function"==typeof d?d():b.updateHistory({value:b.area.value,selectionStart:f,selectionEnd:f+h.length})},b.insert=function(a,c){var d=b.selection(),e=d.start;d.end,b.area.value=d.before+a+d.after,b.select(e+a.length,e+a.length),"function"==typeof c?c():b.updateHistory({value:b.area.value,selectionStart:e+a.length,selectionEnd:e+a.length})},b.wrap=function(a,c,d){var e=b.selection(),f=e.value,g=e.before,h=e.after;b.area.value=g+a+f+c+h,b.select(g.length+a.length,g.length+a.length+f.length),"function"==typeof d?d():b.updateHistory({value:b.area.value,selectionStart:g.length+a.length,selectionEnd:g.length+a.length+f.length})},b.indent=function(a,c){var d=b.selection();d.value.length>0?b.replace(/(^|\n)([^\n])/gm,"$1"+a+"$2",c):(b.area.value=d.before+a+d.value+d.after,b.select(d.start+a.length,d.start+a.length),"function"==typeof c?c():b.updateHistory({value:b.area.value,selectionStart:d.start+a.length,selectionEnd:d.start+a.length}))},b.outdent=function(a,c){var d=b.selection();if(d.value.length>0)b.replace(new RegExp("(^|\n)"+a,"gm"),"$1",c);else{var e=d.before.replace(new RegExp(a+"$"),"");b.area.value=e+d.value+d.after,b.select(e.length,e.length),"function"==typeof c?c():b.updateHistory({value:b.area.value,selectionStart:e.length,selectionEnd:e.length})}},b.callHistory=function(a){return"number"==typeof a?c[a]:c},b.updateHistory=function(a,e){var f="undefined"!=typeof a?a:{value:b.area.value,selectionStart:b.selection().start,selectionEnd:b.selection().end};c["number"==typeof e?e:d]=f,d++},b.undo=function(a){if(c.length>1){d>1?d--:d=1;var f=b.callHistory(d-1);e=0>=d?d-1:d,b.area.value=f.value,b.select(f.selectionStart,f.selectionEnd),"function"==typeof a&&a()}},b.redo=function(a){if(null!==e){var f=b.callHistory(e);e<c.length-1?e++:e=c.length-1,d=e>=c.length-1?e+1:e,b.area.value=f.value,b.select(f.selectionStart,f.selectionEnd),"function"==typeof a&&a()}}};